--------------------------------------------------------
-- INSERTANDO DATOS DIM SQL
--------------------------------------------------------
INSERT INTO DIM_MM_BANCOS(COD_ENTIDAD,BANCO)
SELECT COD_ENTIDAD,DES_BANCO FROM MM_BANCOS;

INSERT INTO DIM_MM_ONPE(COD_NUMDOC,COD_UBIGEO,SEXO,EDAD)
SELECT COD_NUMDOC,
    COD_UBIGEO,
CASE WHEN FLG_SEXO='1' THEN 'Masculino'
WHEN FLG_SEXO='2' THEN 'Femenino' ELSE ' ' END,
ROUND((months_between(sysdate,FECNAC)/12),0)
FROM MM_ONPE;
COMMIT;
 
INSERT INTO DIM_MM_CLIENTES(PERIODO,COD_SBS_CLI,COD_NUMDOC,TIP_DOC,SEGMENTO,CALIFICACION)
SELECT PERIODO,
COD_SBS_CLI,
COD_NUMDOC,
case  when TIP_DOC_IDE=1 then 'DNI'
when TIP_DOC_IDE=2 THEN 'Carné de Extranjeria'
when TIP_DOC_IDE=5 then 'Pasaporte' else
'Otros' end,
case  when TIP_PERSONA=1 then 'Persona Natural'
when TIP_PERSONA=3 then 'Personas Mancomunadas'
when TIP_PERSONA=4 then 'Patrimonios fideicometidos y vehiculos proposito especial'
else 'Otros' end,
CASE WHEN DEU_CALIF0 > 0 AND DEU_CALIF0 > DEU_CALIF1 AND DEU_CALIF0 > DEU_CALIF2 AND DEU_CALIF0 > DEU_CALIF3 AND DEU_CALIF0 > DEU_CALIF4 THEN 'Normal'
WHEN DEU_CALIF1 > 0 AND DEU_CALIF1 > DEU_CALIF0 AND DEU_CALIF1 > DEU_CALIF2 AND DEU_CALIF1 > DEU_CALIF3 AND DEU_CALIF1 > DEU_CALIF4 THEN 'CPP'
WHEN DEU_CALIF2 > 0 AND DEU_CALIF2 > DEU_CALIF1 AND DEU_CALIF2 > DEU_CALIF0 AND DEU_CALIF2 > DEU_CALIF3 AND DEU_CALIF2 > DEU_CALIF4 THEN 'Deficiente'
WHEN DEU_CALIF3 > 0 AND DEU_CALIF3 > DEU_CALIF1 AND DEU_CALIF3 > DEU_CALIF2 AND DEU_CALIF3 > DEU_CALIF0 AND DEU_CALIF3 > DEU_CALIF4 THEN 'Dudoso'
WHEN DEU_CALIF4 > 0 AND DEU_CALIF4 > DEU_CALIF1 AND DEU_CALIF4 > DEU_CALIF2 AND DEU_CALIF4 > DEU_CALIF3 AND DEU_CALIF4 > DEU_CALIF0 THEN 'Perdida'
WHEN DEU_CALIF4 = 0 AND DEU_CALIF1 = 0 AND  DEU_CALIF2 = 0 AND  DEU_CALIF3 = 0 AND DEU_CALIF0 = 0 THEN 'Normal'
WHEN DEU_CALIF4 = 50 THEN 'Perdida'
WHEN DEU_CALIF3 = 50 THEN 'Dudoso' 
WHEN DEU_CALIF2 = 50 THEN 'Deficiente'
WHEN DEU_CALIF1 = 50 THEN 'CPP' end
FROM MM_CLIENTES;
commit;


INSERT INTO DIM_PRODUCTOSBS VALUES (	100	,	 'Prestamo Pequeña Empresa');
INSERT INTO DIM_PRODUCTOSBS VALUES (	200	,	 'Prestamo MicroEmpresa');
INSERT INTO DIM_PRODUCTOSBS VALUES (	300	,	 'Prestamo Hipotecario');
INSERT INTO DIM_PRODUCTOSBS VALUES (	400	,	 'Prestamo de Consumo');
INSERT INTO DIM_PRODUCTOSBS VALUES (	500	,	 'Tarjeta de Credito');
INSERT INTO DIM_PRODUCTOSBS VALUES (	600	,	 'Otras cuentas contables');

INSERT INTO DIM_SUBPRODUCTOSBS VALUES (	1	,	100	,	 '	Prestamo Pequeña Empresa	 ');
INSERT INTO DIM_SUBPRODUCTOSBS VALUES (	2	,	200	,	 'Prestamo MicroEmpresa');
INSERT INTO DIM_SUBPRODUCTOSBS VALUES (	3	,	300	,	 'HIPOTECARIO NORMAL ');
INSERT INTO DIM_SUBPRODUCTOSBS VALUES (	4	,	300	,	 'HIPOTECARIO MIVIVIENDA ');
INSERT INTO DIM_SUBPRODUCTOSBS VALUES (	5	,	400	,	 'PRESTAMO EFECTIVO');
INSERT INTO DIM_SUBPRODUCTOSBS VALUES (	6	,	400	,	 'PRESTAMO VEHICULAR');
INSERT INTO DIM_SUBPRODUCTOSBS VALUES (	7	,	500	,	 'SALDO DE TARJETA DE CREDITO');
INSERT INTO DIM_SUBPRODUCTOSBS VALUES (	8	,	500	,	 'LINEA DE TARJETA DE CREDITO');
INSERT INTO DIM_SUBPRODUCTOSBS VALUES (	9	,	600	,	 'OTRAS CUENTAS CONTABLES');


COMMIT;